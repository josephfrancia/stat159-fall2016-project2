1/0
1/0
data=read.csv("http://www-bcf.usc.edu/~gareth/ISL/Credit.csv")
load(file="../../data/test_train.RData")
load(file="../../data/ridge.RData")
load(file="../../data/plsr.RData")
load(file="../../data/lm.RData")
#Creating MSE table
mse=data.frame(c(mse_lm, mse_ridge, mse_plsr))
rownames(mse)=c("MSE of Least Squares", "MSE of Ridge Regression", "MSE of PLS Regression")
colnames(mse)=c("Mean Squared Error")
save(mse,file="../../data/mse_table.RData")
#Creating table of coefficients
betas_plsr=as.data.frame(betas_plsr)
betas_plsr=betas_plsr[,5]
betas_ridge=as.numeric(betas_ridge)
betas_ls=as.numeric(lm_obj$coefficients)[2:12]
beta_names=c("Income", "Limit", "Rating", "Cards", "Age", "Education", "Gender.Male", "GenderFemale", "MarriedYes", "EthnicityAsian", "EthnicityCaucasian")
betas=data.frame(beta_names,betas_plsr, betas_ls, betas_ridge)
colnames(betas)=c("Coefficient Names","Coefficients for PLS Regression", "Coefficients for Least Squares", "Coefficients for Ridge Regression")
save(betas,file="../../data/coef_table.RData")
load(file="../../data/test_train.RData")
lm_obj=lm(Balance~.,data=train)
y_hat=predict(lm_obj, newdata=test[,-12])
plot(y_hat-test[,12])
mse_lm=mean((y_hat-test[,12])^2)
save(lm_obj,mse_lm,file="../../data/lm.RData")
load(file="../../data/test_train.RData")
load(file="../../data/ridge.RData")
load(file="../../data/plsr.RData")
load(file="../../data/lm.RData")
#Creating MSE table
mse=data.frame(c(mse_lm, mse_ridge, mse_plsr))
rownames(mse)=c("MSE of Least Squares", "MSE of Ridge Regression", "MSE of PLS Regression")
colnames(mse)=c("Mean Squared Error")
save(mse,file="../../data/mse_table.RData")
#Creating table of coefficients
betas_plsr=as.data.frame(betas_plsr)
betas_plsr=betas_plsr[,5]
betas_ridge=as.numeric(betas_ridge)
betas_ls=as.numeric(lm_obj$coefficients)[2:12]
beta_names=c("Income", "Limit", "Rating", "Cards", "Age", "Education", "Gender.Male", "GenderFemale", "MarriedYes", "EthnicityAsian", "EthnicityCaucasian")
betas=data.frame(beta_names,betas_plsr, betas_ls, betas_ridge)
colnames(betas)=c("Coefficient Names","Coefficients for PLS Regression", "Coefficients for Least Squares", "Coefficients for Ridge Regression")
save(betas,file="../../data/coef_table.RData")
View(betas)
require(ggplot2)
colnames(betas)=c("Coefficient Names","Coefficients for PLS Regression", "Coefficients for Least Squares", "Coefficients for Ridge Regression")
save(betas,file="../../data/coef_table.RData")
ggplot(betas, aes(x=Coefficient Names, y=c(Coe) ))
betas1=betas
colnames(betas1)=c("Coef_Names", "Coef_PLS", "Coef_LS", "Coef_Rid")
c <- ggplot(betas, aes(x=Coef_Names,y=Coef_PLS)
)
c + geom_bar()
c <- ggplot(betas1, aes(x=Coef_Names,y=Coef_PLS))
c + geom_bar()
betas1=betas
colnames(betas1)=c("Coef_Names", "Coef_PLS", "Coef_LS", "Coef_Rid")
c <- ggplot(betas1, aes(x=Coef_Names,y=Coef_PLS))
c + geom_bar(stat="identity")
?melt()
melt
install.package("reshape")
install.packages("reshape")
library(reshape)
library(reshape2)
?melt()
plot(betas)
betas
View(betas)
plot(betas[1,])
plot(betas[1,])
betas[1,]
plot(as.numeric(betas[1,]))
plot(as.numeric(betas[1,2:4]))
plot(seq(1,3, by=1,as.numeric(betas[1,2:4]))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]))
axis(labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
#Creating a barplot of coefficients
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
coefficients
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
lines(as.numeric(betas[2,2:4]))
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value")
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-1,1))
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-1,1), main="Coefficient Values For Each Regression")
#Creating a barplot of coefficients
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-1,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
load(file="../../data/coef_table.RData")
png(filename="../../images/coefficient_plot.png")
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-1,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
dev.off()
rownames(betas)
betas
betas$`Coefficient Names`
legend(3,-.5, c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
legend(2,-.5, c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
png(filename="../../images/coefficient_plot.png")
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-2,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
legend(2,-.3, c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
dev.off()
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-2,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
legend(2,-.3, c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-2,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
legend(2,-.7, c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-2,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
legend(2,-.7, bty="n", c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-2,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
legend(1.5,-.7, bty="n", c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
png(filename="../../images/coefficient_plot.png")
plot(seq(1,3, by=1),as.numeric(betas[1,2:4]), xaxt="n", type="l", col="red",xlab="Regression Type", ylab="Coefficient Value", ylim=c(-2,1), main="Coefficient Values For Each Regression")
lines(seq(1,3, by=1),as.numeric(betas[2,2:4]), col="blue")
lines(seq(1,3, by=1),as.numeric(betas[3,2:4]), col="red")
lines(seq(1,3, by=1),as.numeric(betas[4,2:4]), col="yellow")
lines(seq(1,3, by=1),as.numeric(betas[5,2:4]), col="green")
lines(seq(1,3, by=1),as.numeric(betas[6,2:4]), col="orange")
lines(seq(1,3, by=1),as.numeric(betas[7,2:4]), col="purple")
lines(seq(1,3, by=1),as.numeric(betas[8,2:4]), col="black")
lines(seq(1,3, by=1),as.numeric(betas[9,2:4]), col="gray")
lines(seq(1,3, by=1),as.numeric(betas[10,2:4]), col="brown")
lines(seq(1,3, by=1),as.numeric(betas[11,2:4]), col="tomato")
axis(side=1,labels=c("PLS", "OLS", "Ridge"), at=c(1,2,3))
legend(1.5,-.7, bty="n", c("Income","Limit", "Rating", "Cards", "Age", "Education", "Gender.Male",
"GenderFemale","MarriedYes", "EthnicityAsian","EthnicityCaucasian"),
lty=c(1,1),  lwd=c(2.5,2.5),col=c("blue","red", "yellow", "green","orange",
"purple", "black", "gray","brown", "tomato"))
dev.off()
