Summary Table for Relevant Regression Statistics
```{r pressure, echo=FALSE}
print(reg_summary)
```
?stargazer
reg_summary=stargazer(reg_obj, probit.model, title= "Regression Results", align= TRUE)
stargazer(reg_obj, title= "Regression Results", align= TRUE)
install.packages("dcolumn")
library(dcolumn)
library(stargazer)
data=read.csv("http://www-bcf.usc.edu/~gareth/ISL/Advertising.csv")
reg_obj=lm(TV~Sales, data=data)
reg_summary=summary(reg_obj)
#Saving plot as png
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.png")
plot(data$Sales, data$TV, main="Scatterplot with Regression Line", xlab="Sales", ylab="TV Advertisements")
abline(reg_obj)
dev.off()
#Saving plot as pdf
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.pdf")
plot(data$Sales, data$TV, main="Scatterplot with Regression Line", xlab="Sales", ylab="TV Advertisements")
abline(reg_obj)
dev.off()
save(data, reg_obj,reg_summary, file="/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/regression.RData")
write.csv(data, file="/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/Advertising.csv")
data=read.csv("http://www-bcf.usc.edu/~gareth/ISL/Advertising.csv")
#TV Histogram
tv_summary=summary(data$TV)
cat("TV Summary Statistics\n\n", file="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/eda-output.txt")
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-tv.png")
hist(data$TV)
dev.off()
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-tv.pdf")
hist(data$TV)
dev.off()
#Sales Histogram
summary(data$Sales)
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-sales.png")
hist(data$Sales)
dev.off()
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-sales.pdf")
hist(data$Sales)
dev.off()
#Sales and TV textfiles
sink(file="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/eda-output.txt")
summary(data$TV)
summary(data$Sales)
sink()
```{r cars, echo=FALSE}
load("/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/regression.RData")
```
![Relationship Between TV Advertisements and Sales](/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.png)
Summary Table for Relevant Regression Statistics
```{r pressure, echo=FALSE}
print(reg_summary)
simulate_one=function(initial_bet, multiplier){
outcomes = c(rep(-1, 55), rep(1, 45))
outcome = sample(outcomes, size = 1)
if(outcome==1){
gain=initial_bet*multiplier
return(gain)
}
loss=initial_bet*multiplier*-1
return(loss)
}
simulate_turns = function(initial_bet, strategy, numBets) {
outcomes = c(rep(-1, 55), rep(1, 45))
multiplier=1
result=vector()
for(i in 1:numBets) {
result[i]=simulate_one(initial_bet, multiplier)
if(result[i]<0){
multiplier=strategy*multiplier
}
else{
multiplier=1
}
}
return((result))
}
#Extracting maximum amount of money you have to be willing to bet
catastrophic_loss=function(initial_bet, strategy, numBets, times){
dist=vector()
for(i in 1:times){
dist[i]=max(simulate_turns(1,2,100))
}
plot(dist)
}
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(5, 2, 100, 100)
catastrophic_loss(1, 2, 10, 100)
catastrophic_loss(1, 2, 10, 100)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
catastrophic_loss(1, 2, 10, 10)
data=read.csv("http://www-bcf.usc.edu/~gareth/ISL/Advertising.csv")
#TV Histogram
tv_summary=summary(data$TV)
cat("TV Summary Statistics\n\n", file="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/eda-output.txt")
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-tv.png")
hist(data$TV)
dev.off()
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-tv.pdf")
hist(data$TV)
dev.off()
#Sales Histogram
summary(data$Sales)
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-sales.png")
hist(data$Sales)
dev.off()
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-sales.pdf")
hist(data$Sales)
dev.off()
#Sales and TV textfiles
sink(file="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/eda-output.txt")
summary(data$TV)
summary(data$Sales)
sink()
library(stargazer)
data=read.csv("http://www-bcf.usc.edu/~gareth/ISL/Advertising.csv")
reg_obj=lm(TV~Sales, data=data)
reg_summary=summary(reg_obj)
#Saving plot as png
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.png")
plot(data$Sales, data$TV, main="Scatterplot with Regression Line", xlab="Sales", ylab="TV Advertisements")
abline(reg_obj)
dev.off()
#Saving plot as pdf
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.pdf")
plot(data$Sales, data$TV, main="Scatterplot with Regression Line", xlab="Sales", ylab="TV Advertisements")
abline(reg_obj)
dev.off()
save(data, reg_obj,reg_summary, file="/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/regression.RData")
write.csv(data, file="/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/Advertising.csv")
c("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/",args, sep="")
cat("3", "2")
cat("3", "2", sep="")
class(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data",lasjdfl;sj, sep=""))
class(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data","jlasdjf", sep=""))
reg_obj=lm(TV~Sales, data=data)
reg_summary=summary(reg_obj)
#Saving plot as png
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.png")
plot(data$Sales, data$TV, main="Scatterplot with Regression Line", xlab="Sales", ylab="TV Advertisements")
abline(reg_obj)
dev.off()
#Saving plot as pdf
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/scatterplot-tv-sales.pdf")
plot(data$Sales, data$TV, main="Scatterplot with Regression Line", xlab="Sales", ylab="TV Advertisements")
abline(reg_obj)
dev.off()
save(data, reg_obj,reg_summary, file="/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/regression.RData")
write.csv(data, file="/Users/josephfrancia/desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/Advertising.csv")
#TV Histogram
tv_summary=summary(data$TV)
cat("TV Summary Statistics\n\n", file="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/eda-output.txt")
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-tv.png")
hist(data$TV)
dev.off()
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-tv.pdf")
hist(data$TV)
dev.off()
#Sales Histogram
summary(data$Sales)
png(filename="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-sales.png")
hist(data$Sales)
dev.off()
pdf("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/images/histogram-sales.pdf")
hist(data$Sales)
dev.off()
#Sales and TV textfiles
sink(file="/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/eda-output.txt")
summary(data$TV)
summary(data$Sales)
sink()
cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", c("Advertising.csv"), sep="")
cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")
z=cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")
read.csv(z)
read.csv(c("z"))
read.csv("z")
read.csv(z)
read.csv(z)
z
cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")
read.csv(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
read.csv(file=cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
read.csv(as.char(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/"), "Advertising.csv", sep=""))
read.csv(as.character(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/"), "Advertising.csv", sep=""))
read.csv("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/Advertising.csv")
read.csv(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")
)
read.csv(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
class(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
str(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
str(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
toString(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
toString(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))[1]
toString(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))[[1]
toString(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))[[1]]
toString(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
read.csv(toString(cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")))
read.csv(c("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
read.csv(c("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
read.csv(c("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv"))
c("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv")
cat("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv")
pasate("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")
paste("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")
paste("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep="")[1]
read.csv(paste("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-hw02/data/", "Advertising.csv", sep=""))
read.txt("https://piazza-resources.s3.amazonaws.com/isai0nn0zvc12j/itgbmkupc8q2g4/bodyfat_corrected.txt?AWSAccessKeyId=AKIAIEDNRLJ4AZKBW6HA&Expires=1477039259&Signature=JcR8kTdOz3%2BlsIZY64cHlNQtmlM%3D")
bodyfat=read.table(url(https://piazza-resources.s3.amazonaws.com/isai0nn0zvc12j/itgbmkupc8q2g4/bodyfat_corrected.txt?AWSAccessKeyId=AKIAIEDNRLJ4AZKBW6HA&Expires=1477039259&Signature=JcR8kTdOz3%2BlsIZY64cHlNQtmlM%3D))
bodyfat=read.table(url("https://piazza-resources.s3.amazonaws.com/isai0nn0zvc12j/itgbmkupc8q2g4/bodyfat_corrected.txt?AWSAccessKeyId=AKIAIEDNRLJ4AZKBW6HA&Expires=1477039259&Signature=JcR8kTdOz3%2BlsIZY64cHlNQtmlM%3D"))
View(bodyfat)
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH)
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat)
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat)
bodyfat=read.table(url("https://piazza-resources.s3.amazonaws.com/isai0nn0zvc12j/itgbmkupc8q2g4/bodyfat_corrected.txt?AWSAccessKeyId=AKIAIEDNRLJ4AZKBW6HA&Expires=1477039259&Signature=JcR8kTdOz3%2BlsIZY64cHlNQtmlM%3D"), header=FALSE)
View(bodyfat)
bodyfat=read.table(url("https://piazza-resources.s3.amazonaws.com/isai0nn0zvc12j/itgbmkupc8q2g4/bodyfat_corrected.txt?AWSAccessKeyId=AKIAIEDNRLJ4AZKBW6HA&Expires=1477039259&Signature=JcR8kTdOz3%2BlsIZY64cHlNQtmlM%3D"), header=TRUE)
View(bodyfat)
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat)
plot(model)
plot(model, which=2)
plot(model, which=3)
plot(model, which=4)
plot(model, which=5)
plot(model, which=1)
plot(model, which=3)
plot(model, which=2)
plot(model, which=4)
plot(model, which=5)
plot(model)
summary(model)
names(summary(model))
names(model)
rstandard
?rstandard
install.packages("MASS")
library(MASS)
standard_res=stdres(model)
standard_res
names(model)
plot(model$residuals, standard_res)
plot(model, which=4)
plot(model, which=1)
plot(model, which=2)
plot(model, which=3)
plot(model, which=4)
plot(model, which=5)
plot(model, which=4)
plot(model, which=3)
standard_res=stdres(model)
plot(model$residuals, standard_res)
plot(model$residuals, standard_res)
plot(model, which=3)
plot(model, which=1)
plot(model, which=4)
plot(model, which=5)
plot(model, which=5)
head(bodyfat)
head(bodyfat[-2,])
head(bodyfat[-1,])
head(bodyfat[-2,])
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat[-2,])
pred(model,bodyfat[2,])
predict(model,bodyfat[2,])
bodyfat[2,"BODYFAT"]-pred
pred=predict(model,bodyfat[2,])
bodyfat[2,"BODYFAT"]-pred
summary(model)
names(model)
pred_resid=vector()
for(i in 1:nrow(bodyfat)){
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat[-i,])
pred=predict(model,bodyfat[2,])
pred_resid[i]=bodyfat[i,"BODYFAT"]-pred
}
plot(pred_resid,model$fitted.values)
model=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat)
length(model$fitted.values)
length(pred_resid)
pred_resid=vector()
for(i in 1:nrow(bodyfat)){
model_dummy=lm(BODYFAT~AGE+WEIGHT+HEIGHT+THIGH, data=bodyfat[-i,])
pred=predict(model,bodyfat[2,])
pred_resid[i]=bodyfat[i,"BODYFAT"]-pred
}
plot(pred_resid,model$fitted.values)
plot(model$fitted.values, pred_resid)
plot(model$fitted.values, pred_resid, ylab="Predicted Residuals", xlab="Fitted Values")
plot(model$residuals, pred_resid, ylab="Residuals", xlab="Predicted Residiuals")
?studres
plot(pred_resid, studres(model), ylab="Predicted Residuals", xlab="Standardized Predicted Residuals")
?plot()
{r H}
plot(stdres(model), studres(model), xlab="Standardized Residuals", ylab="Standardized Predicted Residuals")
plot(model, which=3)
plot(model$residuals, standard_res)
plot(pred_resid, studres(model), ylab="Predicted Residuals", xlab="Standardized Predicted Residuals")
plot(studres(model), stdres(model), ylab="Standardized Residuals", xlab="Standardized Predicted Residuals")
plot(model, which=5)
plot(pred_resid, model$residuals,ylab="Residuals", xlab="Predicted Residiuals")
plot(model, which=3)
plot(model, which=1)
plot(stdres(model))
model
summary(model)
abs_jacknife=abs(stdres(model))
p_vals=pt(abs_jacknife, 247, lower.tail=FALSE)
p_vals
which(p_vals<.05)
p_vals
p_vals=pt(abs_jacknife, 247, lower=FALSE)
which(p_vals<.05)
p_vals
class(p_vals)
plot(p_vals)
.05/252
which(p_vals<.05/nrow(bodyfat))
setwd("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-project2/code/scripts")
load(file="../../data/test_train.RData")
install.packages("pls")
library(pls)
View(train)
plsr_obj=plsr(Balance~.,data=train[,-c(1,2)])
processed=read.csv("../../data/scaled-credit.csv")
dim(processed)
unprocessed_data<-read.csv("http://www-bcf.usc.edu/~gareth/ISL/Credit.csv")
##Turn categorical variables into dummy variables
processed<-model.matrix(~0+., unprocessed_data[,-9])
##normalize non-categorical explanotory variables
for (i in c(2:7,13)){
processed[,i]<-scale(processed[,i])
}
dim(processed)
data
unprocessed_data<-read.csv("http://www-bcf.usc.edu/~gareth/ISL/Credit.csv")
##Turn categorical variables into dummy variables
processed<-model.matrix(~0+., unprocessed_data[,-9])
dim(processed)
View(processed)
unprocessed_data<-read.csv("http://www-bcf.usc.edu/~gareth/ISL/Credit.csv")
View(unprocessed_data)
dim(unprocessed_data)
dim(processed_data)
dim(processed)
c(2:7,13)
summary(plsr_obj)
plot(RSMEP(plsr_obj))
plot(RMSEP(plsr_obj), legendpos="topright")
View(test)
dim(test)
predict(plsr_obj, ncomp=3, newdata=test[,-c(1,2,14)])
plot(y_hat, test[,14])
y_hat=predict(plsr_obj, ncomp=3, newdata=test[,-c(1,2,14)])
plot(y_hat, test[,14])
setwd("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-project2/code/scripts")
load(file="../../data/test_train.RData")
ridge_obj=glmnet(as.matrix(train[,-c(1,2,14)]), train[,14])
avg_error=vector()
for(i in 1:length(ridge_obj$lambda)){
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,i]
avg_error[i]=mean(y_hat - test[,14])
}
opt_indices=which(abs(avg_error)==min(abs(avg_error)))
opt_lambda=ridge_obj$lambda[opt_indices]
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,opt_indices]
plot(y_hat-test[,14])
plot(RMSEP(plsr_obj), legendpos="topright")
plot(plsr_obj, ncomp=3)
plot(plsr_obj, ncomp=5, asp=1, line=TRUE)
y_hat=predict(plsr_obj, ncomp=3, newdata=test[,-c(1,2,14)])
avg_error
setwd("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-project2/code/scripts")
load(file="../../data/test_train.RData")
ridge_obj=glmnet(as.matrix(train[,-c(1,2,14)]), train[,14])
avg_error=vector()
for(i in 1:length(ridge_obj$lambda)){
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,i]
avg_error[i]=mean(y_hat - test[,14])
}
opt_indices=which(abs(avg_error)==min(abs(avg_error)))
opt_lambda=ridge_obj$lambda[opt_indices]
setwd("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-project2/code/scripts")
load(file="../../data/test_train.RData")
library(glmnet)
ridge_obj=glmnet(as.matrix(train[,-c(1,2,14)]), train[,14])
avg_error=vector()
for(i in 1:length(ridge_obj$lambda)){
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,i]
avg_error[i]=mean(y_hat - test[,14])
}
avg_error
sum(avg_error)
opt_indices=which(abs(avg_error)==min(abs(avg_error)))
opt_lambda=ridge_obj$lambda[opt_indices]
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,opt_indices]
plot(y_hat-test[,14])
sum(y_hat-test[,14])
plot(y_hat-test[,14])
library(pls)
load(file="../../data/test_train.RData")
plsr_obj=plsr(Balance~.,data=train[,-c(1,2)])
summary(plsr_obj)
plot(RMSEP(plsr_obj), legendpos="topright") #Plotting Accuracy as we increase # of Components
plot(plsr_obj, ncomp=5, asp=1, line=TRUE) #Plotting Accuracy for a specific number of components
y_hat=predict(plsr_obj, ncomp=3, newdata=test[,-c(1,2,14)])
plot(y_hat-test[,14])
library(pls)
load(file="../../data/test_train.RData")
plsr_obj=plsr(Balance~.,data=train[,-c(1,2)])
summary(plsr_obj)
plot(RMSEP(plsr_obj), legendpos="topright") #Plotting Accuracy as we increase # of Components
plot(plsr_obj, ncomp=5, asp=1, line=TRUE) #Plotting Accuracy for a specific number of components
y_hat=predict(plsr_obj, ncomp=3, newdata=test[,-c(1,2,14)])
plot(y_hat-test[,14])
plot(y_hat-test[,14])
sum(y_hat-test[,14])
mean(y_hat-test[,14])
mean(y_hat-test[,14])
setwd("/Users/josephfrancia/Desktop/Fall_2016/Stats159/stat159-fall2016-project2/code/scripts")
load(file="../../data/test_train.RData")
library(glmnet)
ridge_obj=glmnet(as.matrix(train[,-c(1,2,14)]), train[,14])
avg_error=vector()
for(i in 1:length(ridge_obj$lambda)){
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,i]
avg_error[i]=mean(y_hat - test[,14])
}
opt_indices=which(abs(avg_error)==min(abs(avg_error)))
opt_lambda=ridge_obj$lambda[opt_indices]
y_hat=as.matrix(cbind(test[-c(1,2,14)])) %*% ridge_obj$beta[,opt_indices]
plot(y_hat-test[,14])
mean(y_hat-test[,14])
View(processed)
processed=read.csv("../../data/scaled-credit.csv")
View(processed)
lm_obj=(Balance~., data=processed[,-c(1,2)])
lm_obj=(Balance~.,data=processed[,-c(1,2)])
lm_obj=lm(Balance~.,data=processed[,-c(1,2)])
load(file="../../data/test_train.RData")
load(file="../../data/test_train.RData")
View(train)
View(test)
dim(test)
y_hat=predict(lm_obj, newdata=test[,-c(1,2,14)])
lm_obj=lm(Balance~.,data=train[,-c(1,2)])
y_hat=predict(lm_obj, newdata=test[,-c(1,2,14)])
lm_obj
lm_obj$coefficients
lm_obj$coefficients %*% test[,-c(1,2,14)]
lm_obj$coefficients %*% test[,-c(1,2,14)]
test[,-c(1,2,14)] %*% lm_obj$coefficients
class(test)
y_hat=predict(lm_obj, newdata=test[,-c(1,2,14)])
y_hat
plot(y_hat-test[,14])
mean(y_hat-test[,14])
plot(y_hat-test[,14])
mean(y_hat-test[,14])
library(pls)
load(file="../../data/test_train.RData")
plsr_obj=plsr(Balance~.,data=train[,-c(1,2)])
summary(plsr_obj)
plot(RMSEP(plsr_obj), legendpos="topright") #Plotting Accuracy as we increase # of Components
plot(plsr_obj, ncomp=5, asp=1, line=TRUE) #Plotting Accuracy for a specific number of components
y_hat=predict(plsr_obj, ncomp=3, newdata=test[,-c(1,2,14)])
plot(y_hat-test[,14])
mean(y_hat-test[,14])
load(file="../../data/test_train.RData")
lm_obj=lm(Balance~.,data=train[,-c(1,2)])
y_hat=predict(lm_obj, newdata=test[,-c(1,2,14)])
plot(y_hat-test[,14])
mean(y_hat-test[,14])
